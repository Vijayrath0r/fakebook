<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="/images/favicon.png">
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <!-- <link rel="stylesheet" href="/css/style.css"> -->
    <link rel="stylesheet" href="/css/chat.css">
    <link rel="stylesheet" href="/css/profile.css">
    <title>FakeBook</title>
</head>

<body>
    <div class="container">
        <div class="row clearfix">
            <div class="col-lg-12">
                <div class="card chat-app">
                    <div id="plist" class="people-list">
                        <div class="input-group">
                            <input type="hidden" id="email" value="<%= user.email %>">
                            <input type="hidden" id="logedName" value="<%= user.name %>">
                            <input type="hidden" id="sender" value="<%= user.personalId %>">
                            <input type="hidden" id="senderId" value="<%= user._id %>">
                            <input type="hidden" id="reciver" value="<%= user.personalId %>">
                            <span>FakeBook</span>
                        </div>
                        <div class="clearfix userList self-details" id="<%= user.personalId %>">
                            <div>
                                <img src="/images/<%= user.profile %>.svg" alt="avatar" data-toggle="modal"
                                    href="javascript:void(0)" onclick="openProfileModal('<%=user.personalId %>');">
                                <div class="about" style="width: 50%;" onclick="changeReciver('<%=user.personalId %>')">
                                    <div class="name">
                                        <%= user.name %>
                                    </div>
                                    <div class="status"> <i class="fa fa-circle online"></i> Online </div>
                                </div>
                                <div><i class="fa fa-gear" id="self-settings-icon"></i></i></div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <div class="accordion-header" id="headingOne">
                                <button class="accordion-button contacts-heading" type="button"
                                    data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true"
                                    aria-controls="collapseOne">
                                    Contacts
                                </button>
                                <i class="fa fa-refresh" id="refreshContacts"></i>
                                <i class="fa fa-plus" id="addContacts"></i>
                            </div>
                            <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                                data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    <ul class="list-unstyled chat-list mt-2 mb-0" id="chat-sidebar">
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div id="logoutButton">
                            <i class="fa fa-sign-out"></i>
                            Logout
                        </div>
                    </div>
                    <div class="chat">
                        <div class="chat-header clearfix">
                            <div class="row">
                                <div class="col-lg-6" id="profileDetails" style="padding-left: 0;">

                                </div>
                                <div class="col-lg-6 hidden-sm">
                                    <div class="ms-headerBtn">
                                        <a href="javascript:void(0);" class="btn btn-outline-secondary"><i
                                                class="fa fa-camera"></i></a>
                                        <a href="javascript:void(0);" class="btn btn-outline-primary"><i
                                                class="fa fa-image"></i></a>
                                        <a href="javascript:void(0);" class="btn btn-outline-info"><i
                                                class="fa fa-cogs"></i></a>
                                        <a href="javascript:void(0);" class="btn btn-outline-warning"><i
                                                class="fa fa-question"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <ul class="chat-history" class="m-b-0 row" id="messages">
                        </ul>
                        <div class="chat-message clearfix">
                            <div id="send-picture-container">
                                <div>
                                    <input type="file" id="selectImageBtnInput" name="images" multiple hidden>
                                    <button id="selectImageBtn">Select Images</button>
                                </div>
                                <div id="send-picture-container-main">
                                </div>
                            </div>
                            <div class="input-group mb-0">
                                <div id="messageForm">
                                    <div class="input-group-prepend">
                                        <button class="input-group-text" id="send-picture-icon" data-open="0"><i
                                                class="fa  fa-picture-o"></i></button>
                                    </div>
                                    <div class="input-group-prepend">
                                        <button class="input-group-text" id="send-location"><i
                                                class="fa fa-map-marker"></i></button>
                                    </div>
                                    <div class="col-8">
                                        <input type="text" class="form-control" name="message" id="message">
                                    </div>
                                    <div class="input-group-prepend">
                                        <button class="input-group-text" id="send-message"><i
                                                class="fa fa-send"></i></button>
                                        <button class="input-group-text" id="send-picture-message"><i
                                                class="fa fa-send"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade login" id="profileModal">
        <div class="modal-dialog login animated">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="profilepopupcontainer">
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="profilepopupcard p-0">
                                    <div class="card-image">
                                        <img id="profileImage"
                                            src="https://images.pexels.com/photos/2746187/pexels-photo-2746187.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=500"
                                            alt="">
                                    </div>
                                    <div class="card-content d-flex flex-column align-items-center">
                                        <h4 class="pt-2" id="profileName">SomeOne Famous</h4>
                                        <h5>Creative Desinger</h5>

                                        <ul class="social-icons d-flex justify-content-center">
                                            <li style="--i:1">
                                                <a href="#">
                                                    <span class="fa fa-phone text-dark"></span>
                                                </a>
                                            </li>
                                            <li style="--i:2">
                                                <a href="#">
                                                    <span class="fa fa-comment text-dark"></span>
                                                </a>
                                            </li>
                                            <li style="--i:3">
                                                <a href="#">
                                                    <span class="fa fa-user text-dark"></span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="imageModal" class="modal">
        <div class="d-flex h-100">
            <span class="imageModalClose">&times;</span>
            <img class="modal-content" id="fullScreenImage">
        </div>
    </div>
    <script id="profile-template" type="text/html">
        <a id="backBtn"><i class="fa fa-arrow-left"></i></a>
        <a href="javascript:void(0);" data-toggle="modal" data-target="#view_info">
            <img src="/images/{{profile}}.svg" alt="avatar">
        </a>
        <div class="chat-about">
            <h6 class="m-b-0">{{name}}</h6>
            <small>Last seen: 2 hours ago</small>
        </div>
    </script>
    <script id="message-template" type="text/html">
        <li class="clearfix {{dateClass}}" id="{{messageId}}">
            <div class="message-data {{dateClass}}">
                <span class="message-data-time">{{createdAt}}</span>
            </div>
            <div class="message {{senderClass}}"> {{message}} </div>
        </li>
    </script>
    <script id="messages-template" type="text/html">
        {{#messages}}
        <li class="clearfix" id="{{messageId}}">
            <div class="message-data {{dateClass}}">
                <span class="message-data-time">{{name}} -{{createdAt}}</span>
            </div>
            <div class="message {{senderClass}}"> {{message}} </div>
        </li>
        {{/messages}}
    </script>
    <script id="Locationmessage-template" type="text/html">
        <li class="clearfix {{dateClass}}" id="{{messageId}}">
            <div class="message-data {{dateClass}}">
                <span class="message-data-time">{{createdAt}}</span>
            </div>
            <div class="message {{senderClass}}"> <iframe src="{{message}}&amp;t=&amp;z=13&amp;ie=UTF8&amp;iwloc=&amp;output=embed" width=300 height=150 allowfullscreen></iframe> </div>
        </li>
    </script>

    <script id="picturemessage-template" type="text/html">
        <li class="clearfix {{dateClass}}" id="{{messageId}}">
            <div class="message-data {{dateClass}}">
                <span class="message-data-time">{{createdAt}}</span>
            </div>
            <div class="message {{senderClass}}"> <img class="messageImage" src="{{message}}" width=300 /> </div>
        </li>
    </script>

    <script id="sidebar-template" type="text/html">
            {{#users}}
                <li class="clearfix userList" id="{{personalId}}">
                    <img src="/images/{{profile}}.svg" alt="avatar" data-toggle="modal" href="javascript:void(0)"
                    onclick="openProfileModal('{{personalId}}');">
                    <div class="about" onclick="changeReciver('{{personalId}}')">
                        <div class="name">{{name}}</div><span class="unreadcount">{{unreadCount}}</span>
                        <div class="status"> <i class="fa fa-circle {{onlineStatus}}"></i> {{onlineTime}} </div>
                    </div>
                    <div class="waviy">
                        <span>Typing</span>
                        <span class="Jump" style="--i:1">.</span>
                        <span class="Jump" style="--i:2">.</span>
                        <span  class="Jump" style="--i:3">.</span>
                    </div>
                </li>
            {{/users}}
    </script>
    <script id="addContact-template" type="text/html">
        <div class="searchBox">
            <div class="col-8">
                <input type="text" class="form-control" name="searchContact" id="searchContactInput" placeholder="Enter conversationId or Name.">
            </div>
            <div class="input-group-prepend col-2">
                <button class="input-group-text" id="searchContactbtn"><i class="fa fa-search"></i></button>
            </div>
            <div class="input-group-prepend col-2" style="position: relative;">
                <button class="input-group-text" id="friendsRequestRecived" data-requestCount = "11"><i class="fa fa-users"></i></button>
            </div>
        </div>
        <div id="searchResult" style="height: 300px;">
        </div>
    </script>
    <script id="addContactList-template" type="text/html">
        {{#userList}}
            <div class="searchContact">
                <img class="profile" src="/images/{{profile}}.svg" alt="avatar">
                <span>{{name}}</span>
                <i class="fas fa-user-{{alreadyFriend}}" data-personalId="{{_id}}"></i>
            </div>
        {{/userList}}
    </script>
    <script id="friendRequestList-template" type="text/html">
        {{#userList}}
            <div class="searchContact">
                <img class="profile" src="/images/{{profile}}.svg" alt="avatar">
                <span>{{name}}</span>
                <div class="float-right p-2">
                    <a class="btn btn-info acceptBtn" data-personalId="{{_id}}">Accept</a>
                    <a class="btn btn-danger rejectBtn" data-personalId="{{_id}}">Reject</a>
                </div>
            </div>
        {{/userList}}
    </script>
    <script id="unReadLine-template" type="text/html">
        <div class="clearfix unreadDiv">
            <span class="unReadSpan">Unread Messages</span>
        </div>
    </script>
    <script src="./libraries/fontawesome.js"></script>
    <script src="./libraries/jquery.min.js"></script>
    <script src="./libraries/mustache.min.js"></script>
    <script src="./libraries/moment.min.js"></script>
    <script src="./libraries/qs.min.js"></script>
    <script src="./libraries/bootstrap.bundle.min.js"></script>
    <script src="./libraries/sweetalert2.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/chat.js"></script>
</body>

</html>